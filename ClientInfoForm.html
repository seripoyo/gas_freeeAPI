<!DOCTYPE html>
<html>
  <head>
    <base target="_top">
  </head>
  <body>
    <form id="client-info-form">
      <div>
        <label for="client-id">Client ID:</label>
        <input type="text" id="client-id" name="client_id" placeholder="Client ID">
      </div>
      <div>
        <label for="client-secret">Client Secret:</label>
        <input type="text" id="client-secret" name="client_secret" placeholder="Client Secret">
      </div>
      <div>
        <button type="button" onclick="submitForm()">保存</button>
      </div>
    </form>

    <script>
      function submitForm() {
        var clientId = document.getElementById('client-id').value;
        var clientSecret = document.getElementById('client-secret').value;
        google.script.run
          .withSuccessHandler(alertAuth)
          .saveClientInfo(clientId, clientSecret);
      }

      function alertAuth() {
        google.script.run.alertAuth();
        google.script.host.close();
      }
    </script>
  </body>
</html>
